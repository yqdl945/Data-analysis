# 数据分析45讲



## 05|Pandas

- Series
- DataFrame

 ~~~
import pandas as pd
from pandas import DataFrame,Series
# 数据清洗
## 1.删除不必要值——drop(放入要删除的目标参数)
df1 = df1.drop(columns = ['XXX'])
df2 = df1.drop(index = ['YYY'])
## 2.重命名——rename("错误名称":"正确名称")
df2.rename(columns={'Chinese': 'YuWen', 'English': 'Yingyu'}, inplace = True)
## 3.去除重复值——drop_duplicates()
df = df.drop_duplicates() 
## 4.更改格式
### 4.1.astype('str')
df2['Chinese'].astype('str') 
df2['Chinese'].astype(np.int64) 
### 4.2 srip("也可以添加符号用于删除数据中的特殊符号") #默认删除左右空格
df2['Chinese']=df2['Chinese'].map(str.strip())
df2['Chinese']=df2['Chinese'].str.strip('$')

## 找空值——isnull()
 ~~~

### apply()函数清洗
### describe()输出结果！
### lambda

~~~
## merget(a,b,on = "基于目标")
## merget(a,b,how = "inner")
## left/right
## outer
~~~
### 基于SQL打开——pandasql
~~~
import pandas as pd
from pandas import DataFrame
from pandasql import sqldf, load_meat, load_births
df1 = DataFrame({'name':['ZhangFei', 'GuanYu', 'a', 'b', 'c'], 'data1':range(5)})
pysqldf = lambda sql: sqldf(sql, globals())
sql = "select * from df1 where name ='ZhangFei'"
print pysqldf(sql)

~~~
